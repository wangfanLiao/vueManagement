{"version":3,"file":"js/981.b166ba69.js","mappings":"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","sources":["webpack://vue_3.2/./src/api/getOvertime.js","webpack://vue_3.2/./src/utils/handleDbData.js","webpack://vue_3.2/./src/api/addOvertime.js","webpack://vue_3.2/./src/views/addOvertime/index.vue","webpack://vue_3.2/./src/views/addOvertime/index.vue?1485"],"sourcesContent":["import request from './request'\r\n\r\n// by username\r\nconst getOvertime = async (data) => {\r\n  const res = await request({\r\n    url: '/otList',\r\n    method: 'POST',\r\n    data\r\n  })\r\n  return res\r\n}\r\n\r\nexport default getOvertime\r\n","import dayjs from 'dayjs'\r\nimport isLeapYear from 'dayjs/plugin/isLeapYear' // 导入插件\r\nimport 'dayjs/locale/zh-cn' // 导入本地化语言\r\n\r\ndayjs.extend(isLeapYear) // 使用插件\r\ndayjs.locale('zh-cn') // 使用本地化语言\r\n\r\nconst handleData = (userList, overtimeLis) => {\r\n  let hours, count\r\n  const list = []\r\n  userList.forEach((element) => {\r\n    hours = 0\r\n    count = 0\r\n    overtimeLis.forEach((item, index) => {\r\n      if (\r\n        item.username === element.username &&\r\n        dayjs().month() === dayjs(item.startTime).month()\r\n      ) {\r\n        hours += item.overtime\r\n        count += 1\r\n      }\r\n    })\r\n\r\n    list.push({\r\n      username: element.username,\r\n      times: count,\r\n      nowMonthOt: hours\r\n    })\r\n  })\r\n\r\n  return list\r\n}\r\n\r\nexport default handleData\r\n","import request from './request'\r\n\r\nconst addOvertime = (data) => {\r\n  const res = request({\r\n    url: '/addOt',\r\n    method: 'POST',\r\n    data\r\n  })\r\n  return res\r\n}\r\n\r\nexport default addOvertime\r\n","import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-530267af\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"block\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"demonstration\"\n}, \"选择加班时间\", -1));\nconst _hoisted_3 = {\n  class: \"input\"\n};\nconst _hoisted_4 = {\n  class: \"dialog-footer\"\n};\nconst _hoisted_5 = {\n  class: \"timeline\"\n};\nconst _hoisted_6 = {\n  class: \"el-statistic\"\n};\nimport { ref, onMounted } from 'vue';\nimport dateFormat from '@/utils/dateFormat';\nimport addOvertime from '@/api/addOvertime';\nimport getOvertime from '@/api/getOvertime';\nimport { ElMessage } from 'element-plus';\nimport { useTransition } from '@vueuse/core';\nimport handleData from '@/utils/handleDbData';\nexport default {\n  __name: 'index',\n  setup(__props) {\n    let handleres;\n    const dialogTableVisible = ref(false);\n    const content = ref();\n    const timesSource = ref(0);\n    const nowMonthOtSource = ref(0);\n    const timeData = ref();\n    const input = ref();\n    const bool = ref(true);\n    const overtimeList = ref();\n    const data = ref();\n    const times = useTransition(timesSource, {\n      duration: 1500\n    });\n    const nowMonthOt = useTransition(nowMonthOtSource, {\n      duration: 1500\n    });\n    const defaultTime = [new Date(2000, 1, 1, 18, 0, 0), new Date(2000, 1, 1, 20, 0, 0)];\n    const username = {\n      username: localStorage.getItem('username')\n    };\n    const chooseTime = () => {\n      if (timeData.value) {\n        input.value = (timeData.value[1] - timeData.value[0]) / (1000 * 60 * 60);\n        data.value = [{\n          username: username.username,\n          startTime: dateFormat(timeData.value[0]),\n          endTime: dateFormat(timeData.value[1]),\n          overtime: input.value\n        }];\n        bool.value = false;\n      } else {\n        input.value = null;\n        bool.value = true;\n        ElMessage.info('请选择时间');\n      }\n    };\n    const handleAdd = async () => {\n      const res = await addOvertime(data.value[0]);\n      ElMessage(res.meta.message);\n      getOvertimeList();\n      dialogTableVisible.value = false;\n      bool.value = true;\n      timeData.value = null;\n    };\n    const getOvertimeList = async () => {\n      const res = await getOvertime(username);\n      handleres = handleData([username], res.data);\n      timesSource.value = handleres[0].times;\n      nowMonthOtSource.value = handleres[0].nowMonthOt;\n      if (res.data.length === 0) {\n        content.value = '无最近提交记录';\n      } else {\n        content.value = '最近提交记录';\n        const arr = res.data;\n        arr.reverse();\n        overtimeList.value = arr.slice(0, 3);\n      }\n    };\n    onMounted(() => {\n      getOvertimeList();\n    });\n    return (_ctx, _cache) => {\n      const _component_el_date_picker = _resolveComponent(\"el-date-picker\");\n      const _component_el_input = _resolveComponent(\"el-input\");\n      const _component_el_button = _resolveComponent(\"el-button\");\n      const _component_el_col = _resolveComponent(\"el-col\");\n      const _component_el_row = _resolveComponent(\"el-row\");\n      const _component_el_table_column = _resolveComponent(\"el-table-column\");\n      const _component_el_table = _resolveComponent(\"el-table\");\n      const _component_el_dialog = _resolveComponent(\"el-dialog\");\n      const _component_el_card = _resolveComponent(\"el-card\");\n      const _component_el_timeline_item = _resolveComponent(\"el-timeline-item\");\n      const _component_el_timeline = _resolveComponent(\"el-timeline\");\n      const _component_el_statistic = _resolveComponent(\"el-statistic\");\n      return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_el_row, null, {\n        default: _withCtx(() => [_createVNode(_component_el_col, {\n          span: 24\n        }, {\n          default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _createVNode(_component_el_date_picker, {\n            modelValue: timeData.value,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => timeData.value = $event),\n            type: \"datetimerange\",\n            \"start-placeholder\": \"开始时间\",\n            \"end-placeholder\": \"结束时间\",\n            \"default-time\": defaultTime,\n            onChange: chooseTime\n          }, null, 8, [\"modelValue\"])]), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_input, {\n            modelValue: input.value,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => input.value = $event),\n            style: {\n              \"width\": \"240px\"\n            },\n            disabled: \"\",\n            placeholder: \"请选择加班时间\"\n          }, {\n            append: _withCtx(() => [_createTextVNode(\"小时\")]),\n            _: 1\n          }, 8, [\"modelValue\"]), _createVNode(_component_el_button, {\n            type: \"success\",\n            onClick: _cache[2] || (_cache[2] = $event => dialogTableVisible.value = true),\n            disabled: bool.value,\n            plain: \"\"\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"确认\")]),\n            _: 1\n          }, 8, [\"disabled\"])])]),\n          _: 1\n        })]),\n        _: 1\n      }), _createVNode(_component_el_dialog, {\n        modelValue: dialogTableVisible.value,\n        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => dialogTableVisible.value = $event),\n        title: \"确认修改?\",\n        width: \"800\",\n        \"destroy-on-close\": \"\",\n        draggable: \"\",\n        overflow: \"\"\n      }, {\n        footer: _withCtx(() => [_createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_button, {\n          onClick: _cache[3] || (_cache[3] = $event => dialogTableVisible.value = false)\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"取消\")]),\n          _: 1\n        }), _createVNode(_component_el_button, {\n          type: \"primary\",\n          onClick: handleAdd\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" 确认 \")]),\n          _: 1\n        })])]),\n        default: _withCtx(() => [_createVNode(_component_el_table, {\n          data: data.value,\n          style: {\n            \"width\": \"100%\"\n          },\n          border: \"\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_table_column, {\n            property: \"startTime\",\n            label: \"开始时间\",\n            style: {\n              \"width\": \"33%\"\n            }\n          }), _createVNode(_component_el_table_column, {\n            property: \"endTime\",\n            label: \"结束时间\",\n            style: {\n              \"width\": \"33%\"\n            }\n          }), _createVNode(_component_el_table_column, {\n            property: \"overtime\",\n            label: \"加班时长(H)\",\n            style: {\n              \"width\": \"34%\"\n            }\n          })]),\n          _: 1\n        }, 8, [\"data\"])]),\n        _: 1\n      }, 8, [\"modelValue\"]), _createVNode(_component_el_row, null, {\n        default: _withCtx(() => [_createVNode(_component_el_col, {\n          span: 12\n        }, {\n          default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"h2\", null, _toDisplayString(content.value), 1), _createVNode(_component_el_timeline, {\n            style: {\n              \"max-width\": \"460px\"\n            }\n          }, {\n            default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(overtimeList.value, (item, index) => {\n              return _openBlock(), _createBlock(_component_el_timeline_item, {\n                key: index,\n                timestamp: _unref(dateFormat)(item.createTime),\n                placement: \"top\"\n              }, {\n                default: _withCtx(() => [_createVNode(_component_el_card, null, {\n                  default: _withCtx(() => [_createElementVNode(\"h4\", null, \"加班时长\" + _toDisplayString(item.overtime) + \"H\", 1), _createElementVNode(\"p\", null, \"开始时间\" + _toDisplayString(item.startTime), 1), _createElementVNode(\"p\", null, \"结束时间\" + _toDisplayString(item.endTime), 1)]),\n                  _: 2\n                }, 1024)]),\n                _: 2\n              }, 1032, [\"timestamp\"]);\n            }), 128))]),\n            _: 1\n          })])]),\n          _: 1\n        }), _createVNode(_component_el_col, {\n          span: 12\n        }, {\n          default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_el_statistic, {\n            title: \"本月加班次数\",\n            value: _unref(times)\n          }, null, 8, [\"value\"]), _createVNode(_component_el_statistic, {\n            title: \"本月加班时长\",\n            value: _unref(nowMonthOt)\n          }, null, 8, [\"value\"])])]),\n          _: 1\n        })]),\n        _: 1\n      })], 64);\n    };\n  }\n};","/* unplugin-vue-components disabled */import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=530267af&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-530267af\"]])\n\nexport default __exports__"],"names":["getOvertime","async","res","request","url","method","data","dayjs","isLeapYear","handleData","userList","overtimeLis","hours","count","list","forEach","element","item","index","username","month","startTime","overtime","push","times","nowMonthOt","addOvertime","_withScopeId","n","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","__name","setup","__props","handleres","dialogTableVisible","content","timesSource","nowMonthOtSource","timeData","input","bool","overtimeList","duration","defaultTime","Date","localStorage","getItem","chooseTime","value","dateFormat","endTime","info","handleAdd","meta","message","getOvertimeList","length","arr","reverse","slice","_ctx","_cache","_component_el_date_picker","_component_el_input","_component_el_button","_component_el_col","_component_el_row","_component_el_table_column","_component_el_table","_component_el_dialog","_component_el_card","_component_el_timeline_item","_component_el_timeline","_component_el_statistic","default","span","modelValue","$event","type","onChange","style","disabled","placeholder","append","_","onClick","plain","title","width","draggable","overflow","footer","border","property","label","key","timestamp","createTime","placement","__exports__"],"sourceRoot":""}